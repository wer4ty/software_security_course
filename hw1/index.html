<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<!--<meta http-equiv="refresh" content="1">-->
	<title>Enigma</title>
	    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="js/jquery.min.js" type="text/javascript"></script>
    <script src="js/jquery-ui.js" type="text/javascript"></script>
</head>
<body>



<div class="container">
	<div class="row">
		<div class="col-lg-3">

		<h3>Input letter</h3>
		 <input class="form-control" id="plainttext">

		 <h3>Cifer letter</h3>
		 <input disabled="" class="form-control" id="cifertext">

		 <h3>Message</h3>
		 <textarea class="form-control" id="message" rows="3"></textarea>
		 <button class="clear_btn btn btn-primary">Clear</button>

		 </div>

	<!--	 <div class="col-lg-9">

			<table id="table_dynamic" class="table">
  <thead>
    <tr>
      <th scope="col">#</th>
      <th scope="col">Use</th>
      <th scope="col">Ring Setting</th>
      <th scope="col">ABCDEFGHIJKLMNOPQRSTUVWXYZ</th>
      <th scope="col">Turnover notch</th>
      
    </tr>
  </thead>
  <tbody>
    <tr id="r1" class="highlight">
      <th scope="row">I</th>
      <td><input type="checkbox" class="ch_box" checked="true"></td>
      <td><span class="offset_enigma">1</span>
      <button class="left_off btn btn-primary"><</button> <button class="right_off btn btn-primary">></button></td>
      <td><b>E</b>KMFLGDQVZNTOWYHXUSPAIBRCJ</td>
      <td>Q -> R</td>
    </tr>
    <tr id="r2" class="highlight">
      <th scope="row">II</th>
      <td><input type="checkbox" class="ch_box" checked="true"></td>
      <td><span class="offset_enigma">1</span>
      <button class="left_off btn btn-primary"><</button> <button class="right_off btn btn-primary">></button></td>
      <td><b>A</b>JDKSIRUXBLHWTMCQGZNPYFVOE</td>
      <td>E -> F</td>
    </tr>
    <tr id="r3" class="highlight">
      <th scope="row">III</th>
      <td><input type="checkbox" class="ch_box" checked="true"></td>
      <td><span class="offset_enigma">1</span>
      <button class="left_off btn btn-primary"><</button> <button class="right_off btn btn-primary">></button></td>
      <td><b>B</b>DFHJLCPRTXVZNYEIWGAKMUSQO</td>
      <td>V -> W</td>
    </tr>
    <tr id="r4">
      <th scope="row">IV</th>
      <td><input type="checkbox" class="ch_box"></td>
      <td><span class="offset_enigma">1</span>
      <button class="left_off btn btn-primary"><</button> <button class="right_off btn btn-primary">></button></td>
      <td><b>E</b>SOVPZJAYQUIRHXLNFTGKDCMWB</td>
      <td>J -> K</td>
    </tr>
    <tr id="r5">
      <th scope="row">V</th>
      <td><input type="checkbox" class="ch_box"></td>
      <td><span class="offset_enigma">1</span>
      <button class="left_off btn btn-primary"><</button> <button class="right_off btn btn-primary">></button></td>
      <td><b>V</b>ZBRGITYUPSDNHLXAWMJQOFECK</td>
      <td>Z -> A</td>
    </tr>

      
  </tbody>
</table> 

		</div> -->
	</div>
</div>

<script type="text/javascript">

class Substitutor {
	constructor() {}

	isLetter(c) {
		// return whitespace
		if ((c == ' ') || (c == '\t') || (c == '\n')) return c; 
		// check if letter: true => return upper case letter
		let x = c.match(/[a-z]/i);
		if ( x !== null) {
			return x[0].toUpperCase();
		}
		// false return undefined
	  return x;
	}

	indexViaAZ(c) { return "ABCDEFGHIGKLMNOPQRSTUVWXYZ".indexOf(c.toUpperCase()); }
}	

class Translator extends Substitutor {
	constructor(az){
		super();
		this.az = az;
	}

	getAZ() { return this.az; }
	setAz(az) { this.az = az; }

	simple_translate(c) {
		let ind = this.indexViaAZ(c);
		if (this.isLetter(c) === undefined) return;
		else if(ind !== -1 ) return this.az[ind];
		return c;
	}
}

class Plugboard extends Translator {
	constructor(az){
		super(az);
	}
}

class Reflector extends Translator {
	constructor(az){
		super(az);
	}
}

class Rotor extends Translator {
	constructor(az, offset, setting, notch){
		super(az);
		this.offset = offset;
		this.setting = setting;
		this.notch = notch;
	}

	getOffset() { return this.offset; }
	getSetting() { return this.setting; }
	getNotch() { return this.notch; }
}


// 	reflector(
// 		rotor(
// 			rotor( 
// 				rotor(
// 					{c : plugboard(isLetter('a')),  notch_action: true}, 1, "EKMFLGDQVZNTOWYHXUSPAIBRCJ", 'R',1
// 					),
// 				1, "AJDKSIRUXBLHWTMCQGZNPYFVOE", 'F',1),
// 			1, "BDFHJLCPRTXVZNYEIWGAKMUSQO", 'W',1),
// 		"YRUHQSLDPXNGOKMIEBFZCWVJAT"
// 		)

function encrypt(c) {
	let ref = new Reflector("YRUHQSLDPXNGOKMIEBFZCWVJAT");
	let plu = new Plugboard("SUCDEZGHIJKLMNCPQYATBVWXRF");


	let step1 = plu.simple_translate(c);
	let step2 = ref.simple_translate(step1);
	return step2;
}

// Vizualization
$(function(){
	$("#plainttext").keyup(function(){

		let x = $(this).val();
		$("#cifertext").val(encrypt(x[x.length-1]));
		$("#plainttext").val(x[x.length-1]);
		$("#message").val($("#message").val().concat($("#cifertext").val()));
		
	});

	$(".clear_btn").click(function(){
		$("#cifertext, #plainttext, #message").val("");
	});
})

</script>

</body>
</html>